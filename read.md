# 程序结构

    MifFile->DataPack->DataManager->TaskThread->msg->subUI->msg->mainUI

## 各部分组成

## 数据

### 与板子交互的数据

    mif文件解析，考虑用一个统一的数据结构管理文件；
    下发数据包构造，同样考虑用一个统一的数据结构管理下发数据；
    每一个mif文件对应一个mif文对象，
    每一包下发数据对应一个下发数据类对象
    每一个下发数据类对象包含一个mif文件对象的索引
    每一次测试对应一个测试类对象
    每一个测试类对象对象包含多个下发测试类对象
    测试类对象可以多次重复执行测试
    考虑用链表存储数据对象，利用文件名作为数据对象的唯一标识
    考虑到下发数据类和mif文件类的对象是一一对应的，所以用一个整形数据来唯一标识一个mif文件类对象
    流控

#### 数据相关类

    mif文件解析类
    下发数据构造类
    数据管理类

### UI控件存储

    文件列表
    网口配置信息
    SINAD配置信息
    测试配置信息
    测试状态及结果信息

## 线程

    数据接收，
    上报数据派发，
    上报流控包解析，参考asic项目
    上报MNIC数据包解析，考虑用一个统一的数据结构管理数据解析的结果；
    下发数据解析构造，
    数据下发测试，

## UI

### 主窗口

#### 菜单栏

##### 文件

    功能：添加mif文件，显示已添加的文件列表
    点击弹出对话框，在对话框中操作
    在对话框配置完成后点击确定按钮开启线程解析文件并生成数据

##### 配置

###### 网口配置

    配置网络socket
    点击弹框

###### SINAD配置

    功能：配置上报数据有效阈值
    点击弹框

##### 日志

    动态开关日志

#### 主界面

    测试配置
    启动测试
    显示各板子各芯片测试状态
    
## 收发检测部分模型

    [发送线程，接收检测线程、统计线程均属于主界面窗口]
    主界面按钮启动发送线程（检测线程阻塞于事件量A）（统计线程阻塞于事件量B），发送线程计算当前要发送的mif文件的数据量，然后释放信号量A（检测线程从事件量A处唤醒，根据发送的数据量进行有效性检测，检测结果为布尔量，记录标志位也为布尔量，二者与操作获得当前结果）（统计线程依旧阻塞），发送线程发完一个mif文件后等待至流控为空时开始下一次发送（检测线程检测完成后继续阻塞于事件量A）（统计线程阻塞于事件量B），发送线程循环执行上述流程直至发送完最后一个文件，然后释放事件量B,并阻塞在事件量C，（检测线程在检测结束后依旧阻塞于事件量A），（统计线程从事件量B处唤醒， 依据检测结果的布尔值决定检测完成次数是否加1，此操作完成后释放事件量C），发送线程从事件量C处唤醒。之后重复上述流程直至完成检测次数。

## 修改记录

    250311：发送线程开始时有无文件数据的判断

## 笔记

    可以通过给每个线程指定一个独有的id并返回这一id，实现对每一个线程的控制，
    不需要再通过给每个线程指定任务类型的方式来对线程进行控制

## 需求更改记录

### 250314

    将mif文件替换成对应的拥有不同的幅度、频率及持续发送时间的正弦波（通过特定的函数生成该正弦波）
    发送流程，每包依然发送512个采样点的数据，但两包之间的首尾数据应当连续，保证包与包之间的数据是连续的
    另，参数列表的项需要可以上下移动，以调整不同正弦波的发送次序

## 构建命令

    D:\Qt\Tools\CMake_64\bin\cmake.exe -DCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=TRUE --no-warn-unused-cli -SD:/work_space/yuanxin/MNIC/code/MNIC -Bd:/work_space/yuanxin/MNIC/code/MNIC/build -G "Visual Studio 17 2022" -T host=x64 -A x64

## 编译命令

    D:\Qt\Tools\CMake_64\bin\cmake.exe --build d:/work_space/yuanxin/MNIC/code/MNIC/build --config Release --target ALL_BUILD -j 18 --
